import { FocusKeyManager, FocusMonitor } from '@angular/cdk/a11y';
import { ContentChildren, Directive, ElementRef, Input, NgZone, computed, inject, signal, } from '@angular/core';
import { BrnAccordionTriggerDirective } from './brn-accordion-trigger.directive';
import * as i0 from "@angular/core";
const HORIZONTAL_KEYS_TO_PREVENT_DEFAULT = [
    'ArrowLeft',
    'ArrowRight',
    'PageDown',
    'PageUp',
    'Home',
    'End',
    ' ',
    'Enter',
];
const VERTICAL_KEYS_TO_PREVENT_DEFAULT = ['ArrowUp', 'ArrowDown', 'PageDown', 'PageUp', 'Home', 'End', ' ', 'Enter'];
export class BrnAccordionDirective {
    constructor() {
        this._el = inject(ElementRef);
        this._focusMonitor = inject(FocusMonitor);
        this._ngZone = inject(NgZone);
        this._focused = signal(false);
        this._openItemIds = signal([]);
        this.openItemIds = this._openItemIds.asReadonly();
        this.state = computed(() => (this._openItemIds().length > 0 ? 'open' : 'closed'));
        this.type = 'single';
        this.dir = null;
        this.orientation = 'vertical';
    }
    ngAfterContentInit() {
        if (!this.triggers) {
            return;
        }
        this._keyManager = new FocusKeyManager(this.triggers)
            .withHomeAndEnd()
            .withPageUpDown()
            .withWrap();
        if (this.orientation === 'horizontal') {
            this._keyManager.withHorizontalOrientation(this.dir ?? 'ltr').withVerticalOrientation(false);
        }
        this._el.nativeElement.addEventListener('keydown', (event) => {
            this._keyManager?.onKeydown(event);
            this.preventDefaultEvents(event);
        });
        this._focusMonitor.monitor(this._el, true).subscribe((origin) => this._focused.set(origin !== null));
    }
    ngOnDestroy() {
        this._focusMonitor.stopMonitoring(this._el);
    }
    setActiveItem(item) {
        // public setActiveItem(item: number) {
        this._keyManager?.setActiveItem(item);
    }
    toggleItem(id) {
        if (this._openItemIds().includes(id)) {
            this.closeItem(id);
            return;
        }
        this.openItem(id);
    }
    openItem(id) {
        if (this.type === 'single') {
            this._openItemIds.set([id]);
            return;
        }
        this._openItemIds.update((ids) => [...ids, id]);
    }
    closeItem(id) {
        this._openItemIds.update((ids) => ids.filter((openId) => id !== openId));
    }
    preventDefaultEvents(event) {
        if (!this._focused())
            return;
        if (!('key' in event))
            return;
        const keys = this.orientation === 'horizontal' ? HORIZONTAL_KEYS_TO_PREVENT_DEFAULT : VERTICAL_KEYS_TO_PREVENT_DEFAULT;
        if (keys.includes(event.key) && event.code !== 'NumpadEnter') {
            event.preventDefault();
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.5", ngImport: i0, type: BrnAccordionDirective, deps: [], target: i0.ɵɵFactoryTarget.Directive }); }
    static { this.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "17.3.5", type: BrnAccordionDirective, isStandalone: true, selector: "[brnAccordion]", inputs: { type: "type", dir: "dir", orientation: "orientation" }, host: { properties: { "attr.data-state": "state()", "attr.data-orientation": "orientation" } }, queries: [{ propertyName: "triggers", predicate: BrnAccordionTriggerDirective, descendants: true }], ngImport: i0 }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.5", ngImport: i0, type: BrnAccordionDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: '[brnAccordion]',
                    standalone: true,
                    host: {
                        '[attr.data-state]': 'state()',
                        '[attr.data-orientation]': 'orientation',
                    },
                }]
        }], propDecorators: { triggers: [{
                type: ContentChildren,
                args: [BrnAccordionTriggerDirective, { descendants: true }]
            }], type: [{
                type: Input
            }], dir: [{
                type: Input
            }], orientation: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnJuLWFjY29yZGlvbi5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL3VpL2FjY29yZGlvbi9icmFpbi9zcmMvbGliL2Jybi1hY2NvcmRpb24uZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxlQUFlLEVBQUUsWUFBWSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbEUsT0FBTyxFQUNOLGVBQWUsRUFDZixTQUFTLEVBQ1QsVUFBVSxFQUNWLEtBQUssRUFDTCxNQUFNLEVBQ04sUUFBUSxFQUNSLE1BQU0sRUFDTixNQUFNLEdBSU4sTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLDRCQUE0QixFQUFFLE1BQU0sbUNBQW1DLENBQUM7O0FBRWpGLE1BQU0sa0NBQWtDLEdBQUc7SUFDMUMsV0FBVztJQUNYLFlBQVk7SUFDWixVQUFVO0lBQ1YsUUFBUTtJQUNSLE1BQU07SUFDTixLQUFLO0lBQ0wsR0FBRztJQUNILE9BQU87Q0FDUCxDQUFDO0FBQ0YsTUFBTSxnQ0FBZ0MsR0FBRyxDQUFDLFNBQVMsRUFBRSxXQUFXLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQztBQVVySCxNQUFNLE9BQU8scUJBQXFCO0lBUmxDO1FBU2tCLFFBQUcsR0FBRyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUM7UUFFbEMsa0JBQWEsR0FBRyxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDckMsWUFBTyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUVoQixhQUFRLEdBQUcsTUFBTSxDQUFVLEtBQUssQ0FBQyxDQUFDO1FBQ2xDLGlCQUFZLEdBQUcsTUFBTSxDQUFXLEVBQUUsQ0FBQyxDQUFDO1FBQ3JDLGdCQUFXLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxVQUFVLEVBQUUs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QyxRQUFRLEVBQUU7WUFBRSxPQUFPO1FBQzdCLElBQUksQ0FBQyxDQUFDLEtBQUssSUFBSSxLQUFLLENBQUM7WUFBRSxPQUFPO1FBRTlCLE1BQU0sSUFBSSxHQUNULElBQUksQ0FBQyxXQUFXLEtBQUssWUFBWSxDQUFDLENBQUMsQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFDLENBQUMsZ0NBQWdDLENBQUM7UUFDM0csSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxHQUFhLENBQUMsSUFBSSxLQUFLLENBQUMsSUFBSSxLQUFLLGFBQWEsRUFBRSxDQUFDO1lBQ3hFLEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQztRQUN4QixDQUFDO0lBQ0YsQ0FBQzs4R0E3RVcscUJBQXFCO2tHQUFyQixxQkFBcUIscVFBV2hCLDRCQUE0Qjs7MkZBWGpDLHFCQUFxQjtrQkFSakMsU0FBUzttQkFBQztvQkFDVixRQUFRLEVBQUUsZ0JBQWdCO29CQUMxQixVQUFVLEVBQUUsSUFBSTtvQkFDaEIsSUFBSSxFQUFFO3dCQUNMLG1CQUFtQixFQUFFLFNBQVM7d0JBQzlCLHlCQUF5QixFQUFFLGFBQWE7cUJBQ3hDO2lCQUNEOzhCQWFPLFFBQVE7c0JBRGQsZUFBZTt1QkFBQyw0QkFBNEIsRUFBRSxFQUFFLFdBQVcsRUFBRSxJQUFJLEVBQUU7Z0JBSTdELElBQUk7c0JBRFYsS0FBSztnQkFHQyxHQUFHO3NCQURULEtBQUs7Z0JBR0MsV0FBVztzQkFEakIsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEZvY3VzS2V5TWFuYWdlciwgRm9jdXNNb25pdG9yIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2ExMXknO1xuaW1wb3J0IHtcblx0Q29udGVudENoaWxkcmVuLFxuXHREaXJlY3RpdmUsXG5cdEVsZW1lbnRSZWYsXG5cdElucHV0LFxuXHROZ1pvbmUsXG5cdGNvbXB1dGVkLFxuXHRpbmplY3QsXG5cdHNpZ25hbCxcblx0dHlwZSBBZnRlckNvbnRlbnRJbml0LFxuXHR0eXBlIE9uRGVzdHJveSxcblx0dHlwZSBRdWVyeUxpc3QsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQnJuQWNjb3JkaW9uVHJpZ2dlckRpcmVjdGl2ZSB9IGZyb20gJy4vYnJuLWFjY29yZGlvbi10cmlnZ2VyLmRpcmVjdGl2ZSc7XG5cbmNvbnN0IEhPUklaT05UQUxfS0VZU19UT19QUkVWRU5UX0RFRkFVTFQgPSBbXG5cdCdBcnJvd0xlZnQnLFxuXHQnQXJyb3dSaWdodCcsXG5cdCdQYWdlRG93bicsXG5cdCdQYWdlVXAnLFxuXHQnSG9tZScsXG5cdCdFbmQnLFxuXHQnICcsXG5cdCdFbnRlcicsXG5dO1xuY29uc3QgVkVSVElDQUxfS0VZU19UT19QUkVWRU5UX0RFRkFVTFQgPSBbJ0Fycm93VXAnLCAnQXJyb3dEb3duJywgJ1BhZ2VEb3duJywgJ1BhZ2VVcCcsICdIb21lJywgJ0VuZCcsICcgJywgJ0VudGVyJ107XG5cbkBEaXJlY3RpdmUoe1xuXHRzZWxlY3RvcjogJ1ticm5BY2NvcmRpb25dJyxcblx0c3RhbmRhbG9uZTogdHJ1ZSxcblx0aG9zdDoge1xuXHRcdCdbYXR0ci5kYXRhLXN0YXRlXSc6ICdzdGF0ZSgpJyxcblx0XHQnW2F0dHIuZGF0YS1vcmllbnRhdGlvbl0nOiAnb3JpZW50YXRpb24nLFxuXHR9LFxufSlcbmV4cG9ydCBjbGFzcyBCcm5BY2NvcmRpb25EaXJlY3RpdmUgaW1wbGVtZW50cyBBZnRlckNvbnRlbnRJbml0LCBPbkRlc3Ryb3kge1xuXHRwcml2YXRlIHJlYWRvbmx5IF9lbCA9IGluamVjdChFbGVtZW50UmVmKTtcblx0cHJpdmF0ZSBfa2V5TWFuYWdlcj86IEZvY3VzS2V5TWFuYWdlcjxCcm5BY2NvcmRpb25UcmlnZ2VyRGlyZWN0aXZlPjtcblx0cHJpdmF0ZSBfZm9jdXNNb25pdG9yID0gaW5qZWN0KEZvY3VzTW9uaXRvcik7XG5cdHByaXZhdGUgX25nWm9uZSA9IGluamVjdChOZ1pvbmUpO1xuXG5cdHByaXZhdGUgcmVhZG9ubHkgX2ZvY3VzZWQgPSBzaWduYWw8Ym9vbGVhbj4oZmFsc2UpO1xuXHRwcml2YXRlIHJlYWRvbmx5IF9vcGVuSXRlbUlkcyA9IHNpZ25hbDxudW1iZXJbXT4oW10pO1xuXHRwdWJsaWMgcmVhZG9ubHkgb3Blbkl0ZW1JZHMgPSB0aGlzLl9vcGVuSXRlbUlkcy5hc1JlYWRvbmx5KCk7XG5cdHB1YmxpYyByZWFkb25seSBzdGF0ZSA9IGNvbXB1dGVkKCgpID0+ICh0aGlzLl9vcGVuSXRlbUlkcygpLmxlbmd0aCA+IDAgPyAnb3BlbicgOiAnY2xvc2VkJykpO1xuXG5cdEBDb250ZW50Q2hpbGRyZW4oQnJuQWNjb3JkaW9uVHJpZ2dlckRpcmVjdGl2ZSwgeyBkZXNjZW5kYW50czogdHJ1ZSB9KVxuXHRwdWJsaWMgdHJpZ2dlcnM/OiBRdWVyeUxpc3Q8QnJuQWNjb3JkaW9uVHJpZ2dlckRpcmVjdGl2ZT47XG5cblx0QElucHV0KClcblx0cHVibGljIHR5cGU6ICdzaW5nbGUnIHwgJ211bHRpcGxlJyA9ICdzaW5nbGUnO1xuXHRASW5wdXQoKVxuXHRwdWJsaWMgZGlyOiAnbHRyJyB8ICdydGwnIHwgbnVsbCA9IG51bGw7XG5cdEBJbnB1dCgpXG5cdHB1YmxpYyBvcmllbnRhdGlvbjogJ2hvcml6b250YWwnIHwgJ3ZlcnRpY2FsJyA9ICd2ZXJ0aWNhbCc7XG5cblx0cHVibGljIG5nQWZ0ZXJDb250ZW50SW5pdCgpIHtcblx0XHRpZiAoIXRoaXMudHJpZ2dlcnMpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0dGhpcy5fa2V5TWFuYWdlciA9IG5ldyBGb2N1c0tleU1hbmFnZXI8QnJuQWNjb3JkaW9uVHJpZ2dlckRpcmVjdGl2ZT4odGhpcy50cmlnZ2Vycylcblx0XHRcdC53aXRoSG9tZUFuZEVuZCgpXG5cdFx0XHQud2l0aFBhZ2VVcERvd24oKVxuXHRcdFx0LndpdGhXcmFwKCk7XG5cblx0XHRpZiAodGhpcy5vcmllbnRhdGlvbiA9PT0gJ2hvcml6b250YWwnKSB7XG5cdFx0XHR0aGlzLl9rZXlNYW5hZ2VyLndpdGhIb3Jpem9udGFsT3JpZW50YXRpb24odGhpcy5kaXIgPz8gJ2x0cicpLndpdGhWZXJ0aWNhbE9yaWVudGF0aW9uKGZhbHNlKTtcblx0XHR9XG5cdFx0dGhpcy5fZWwubmF0aXZlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGV2ZW50OiBLZXlib2FyZEV2ZW50KSA9PiB7XG5cdFx0XHR0aGlzLl9rZXlNYW5hZ2VyPy5vbktleWRvd24oZXZlbnQgYXMgS2V5Ym9hcmRFdmVudCk7XG5cdFx0XHR0aGlzLnByZXZlbnREZWZhdWx0RXZlbnRzKGV2ZW50IGFzIEtleWJvYXJkRXZlbnQpO1xuXHRcdH0pO1xuXHRcdHRoaXMuX2ZvY3VzTW9uaXRvci5tb25pdG9yKHRoaXMuX2VsLCB0cnVlKS5zdWJzY3JpYmUoKG9yaWdpbikgPT4gdGhpcy5fZm9jdXNlZC5zZXQob3JpZ2luICE9PSBudWxsKSk7XG5cdH1cblxuXHRuZ09uRGVzdHJveSgpOiB2b2lkIHtcblx0XHR0aGlzLl9mb2N1c01vbml0b3Iuc3RvcE1vbml0b3JpbmcodGhpcy5fZWwpO1xuXHR9XG5cblx0cHVibGljIHNldEFjdGl2ZUl0ZW0oaXRlbTogQnJuQWNjb3JkaW9uVHJpZ2dlckRpcmVjdGl2ZSkge1xuXHRcdC8vIHB1YmxpYyBzZXRBY3RpdmVJdGVtKGl0ZW06IG51bWJlcikge1xuXHRcdHRoaXMuX2tleU1hbmFnZXI/LnNldEFjdGl2ZUl0ZW0oaXRlbSk7XG5cdH1cblxuXHRwdWJsaWMgdG9nZ2xlSXRlbShpZDogbnVtYmVyKSB7XG5cdFx0aWYgKHRoaXMuX29wZW5JdGVtSWRzKCkuaW5jbHVkZXMoaWQpKSB7XG5cdFx0XHR0aGlzLmNsb3NlSXRlbShpZCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHRoaXMub3Blbkl0ZW0oaWQpO1xuXHR9XG5cblx0cHVibGljIG9wZW5JdGVtKGlkOiBudW1iZXIpIHtcblx0XHRpZiAodGhpcy50eXBlID09PSAnc2luZ2xlJykge1xuXHRcdFx0dGhpcy5fb3Blbkl0ZW1JZHMuc2V0KFtpZF0pO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR0aGlzLl9vcGVuSXRlbUlkcy51cGRhdGUoKGlkcykgPT4gWy4uLmlkcywgaWRdKTtcblx0fVxuXHRwdWJsaWMgY2xvc2VJdGVtKGlkOiBudW1iZXIpIHtcblx0XHR0aGlzLl9vcGVuSXRlbUlkcy51cGRhdGUoKGlkcykgPT4gaWRzLmZpbHRlcigob3BlbklkKSA9PiBpZCAhPT0gb3BlbklkKSk7XG5cdH1cblxuXHRwcml2YXRlIHByZXZlbnREZWZhdWx0RXZlbnRzKGV2ZW50OiBLZXlib2FyZEV2ZW50KSB7XG5cdFx0aWYgKCF0aGlzLl9mb2N1c2VkKCkpIHJldHVybjtcblx0XHRpZiAoISgna2V5JyBpbiBldmVudCkpIHJldHVybjtcblxuXHRcdGNvbnN0IGtleXMgPVxuXHRcdFx0dGhpcy5vcmllbnRhdGlvbiA9PT0gJ2hvcml6b250YWwnID8gSE9SSVpPTlRBTF9LRVlTX1RPX1BSRVZFTlRfREVGQVVMVCA6IFZFUlRJQ0FMX0tFWVNfVE9fUFJFVkVOVF9ERUZBVUxUO1xuXHRcdGlmIChrZXlzLmluY2x1ZGVzKGV2ZW50LmtleSBhcyBzdHJpbmcpICYmIGV2ZW50LmNvZGUgIT09ICdOdW1wYWRFbnRlcicpIHtcblx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fVxuXHR9XG59XG4iXX0=