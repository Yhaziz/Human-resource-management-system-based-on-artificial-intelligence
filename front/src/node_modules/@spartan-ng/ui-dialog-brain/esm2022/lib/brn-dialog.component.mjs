import { OverlayPositionBuilder, ScrollStrategyOptions, } from '@angular/cdk/overlay';
import { ChangeDetectionStrategy, Component, EventEmitter, Injector, Input, Output, ViewContainerRef, ViewEncapsulation, booleanAttribute, computed, effect, inject, numberAttribute, runInInjectionContext, signal, } from '@angular/core';
import { take } from 'rxjs';
import { DEFAULT_BRN_DIALOG_OPTIONS } from './brn-dialog-options';
import { BrnDialogService } from './brn-dialog.service';
import * as i0 from "@angular/core";
export class BrnDialogComponent {
    constructor() {
        this._dialogService = inject(BrnDialogService);
        this._vcr = inject(ViewContainerRef);
        this.positionBuilder = inject(OverlayPositionBuilder);
        this.ssos = inject(ScrollStrategyOptions);
        this._injector = inject(Injector);
        this._context = {};
        this._options = {
            ...DEFAULT_BRN_DIALOG_OPTIONS,
        };
        this._dialogRef = signal(undefined);
        this.state = computed(() => this._dialogRef()?.state() ?? 'closed');
        this.closed = new EventEmitter();
        this.stateChanged = new EventEmitter();
    }
    // eslint-disable-next-line @angular-eslint/no-input-rename
    set newState(state) {
        if (state === 'open') {
            this.open();
        }
        if (state === 'closed') {
            this.close(this._options['closeDelay']);
        }
    }
    set role(role) {
        this._options['role'] = role;
    }
    set hasBackdrop(hasBackdrop) {
        this._options['hasBackdrop'] = hasBackdrop;
    }
    set positionStrategy(positionStrategy) {
        this._options['positionStrategy'] = positionStrategy;
    }
    set scrollStrategy(scrollStrategy) {
        if (scrollStrategy === 'close') {
            this._options['scrollStrategy'] = this.ssos.close();
        }
        else if (scrollStrategy === 'reposition') {
            this._options['scrollStrategy'] = this.ssos.reposition();
        }
        else {
            this._options['scrollStrategy'] = scrollStrategy;
        }
    }
    set restoreFocus(restoreFocus) {
        this._options['restoreFocus'] = restoreFocus;
    }
    set closeOnOutsidePointerEvents(closeOnOutsidePointerEvents) {
        this._options['closeOnOutsidePointerEvents'] = closeOnOutsidePointerEvents;
    }
    set closeOnBackdropClick(closeOnBackdropClick) {
        this._options['closeOnBackdropClick'] = closeOnBackdropClick;
    }
    set attachTo(attachTo) {
        this._options['attachTo'] = attachTo;
    }
    set attachPositions(attachPositions) {
        this._options['attachPositions'] = attachPositions;
    }
    set autoFocus(autoFocus) {
        this._options['autoFocus'] = autoFocus;
    }
    set closeDelay(closeDelay) {
        this._options['closeDelay'] = closeDelay;
    }
    set disableClose(disableClose) {
        this._options['disableClose'] = disableClose;
    }
    /* eslint-disable-next-line @angular-eslint/no-input-rename */
    set ariaDescribedBy(ariaDescribedBy) {
        this.setAriaDescribedBy(ariaDescribedBy);
    }
    /* eslint-disable-next-line @angular-eslint/no-input-rename */
    set ariaLabelledBy(ariaLabelledBy) {
        this.setAriaLabelledBy(ariaLabelledBy);
    }
    /* eslint-disable-next-line @angular-eslint/no-input-rename */
    set ariaLabel(ariaLabel) {
        this.setAriaLabel(ariaLabel);
    }
    /* eslint-disable-next-line @angular-eslint/no-input-rename */
    set ariaModal(isModal) {
        this.setAriaModal(isModal);
    }
    open() {
        if (!this._contentTemplate || this._dialogRef())
            return;
        this._dialogStateEffectRef?.destroy();
        const dialogRef = this._dialogService.open(this._contentTemplate, this._vcr, this._context, this._options);
        this._dialogRef.set(dialogRef);
        runInInjectionContext(this._injector, () => {
            this._dialogStateEffectRef = effect(() => this.stateChanged.emit(dialogRef.state()));
        });
        dialogRef.closed$.pipe(take(1)).subscribe((result) => {
            this._dialogRef.set(undefined);
            this.closed.emit(result);
        });
    }
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    close(result, delay) {
        this._dialogRef()?.close(result, delay ?? this._options.closeDelay);
    }
    registerTemplate(template) {
        this._contentTemplate = template;
    }
    setOverlayClass(overlayClass) {
        this._options['backdropClass'] = overlayClass ?? '';
        this._dialogRef()?.setOverlayClass(overlayClass);
    }
    setPanelClass(panelClass) {
        this._options['panelClass'] = panelClass ?? '';
        this._dialogRef()?.setPanelClass(panelClass);
    }
    setContext(context) {
        // eslint-disable-next-line @typescript-eslint/ban-ts-comment
        // @ts-expect-error
        this._context = { ...this._context, ...context };
    }
    setAriaDescribedBy(ariaDescribedBy) {
        this._options = { ...this._options, ariaDescribedBy };
        this._dialogRef()?.setAriaDescribedBy(ariaDescribedBy);
    }
    setAriaLabelledBy(ariaLabelledBy) {
        this._options = { ...this._options, ariaLabelledBy };
        this._dialogRef()?.setAriaLabelledBy(ariaLabelledBy);
    }
    setAriaLabel(ariaLabel) {
        this._options = { ...this._options, ariaLabel };
        this._dialogRef()?.setAriaLabel(ariaLabel);
    }
    setAriaModal(ariaModal) {
        this._options = { ...this._options, ariaModal };
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.5", ngImport: i0, type: BrnDialogComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "16.1.0", version: "17.3.5", type: BrnDialogComponent, isStandalone: true, selector: "brn-dialog", inputs: { newState: ["state", "newState"], role: "role", hasBackdrop: ["hasBackdrop", "hasBackdrop", booleanAttribute], positionStrategy: "positionStrategy", scrollStrategy: "scrollStrategy", restoreFocus: "restoreFocus", closeOnOutsidePointerEvents: ["closeOnOutsidePointerEvents", "closeOnOutsidePointerEvents", booleanAttribute], closeOnBackdropClick: ["closeOnBackdropClick", "closeOnBackdropClick", booleanAttribute], attachTo: "attachTo", attachPositions: "attachPositions", autoFocus: "autoFocus", closeDelay: ["closeDelay", "closeDelay", numberAttribute], disableClose: ["disableClose", "disableClose", booleanAttribute], ariaDescribedBy: ["aria-describedby", "ariaDescribedBy"], ariaLabelledBy: ["aria-labelledby", "ariaLabelledBy"], ariaLabel: ["aria-label", "ariaLabel"], ariaModal: ["aria-modal", "ariaModal", booleanAttribute] }, outputs: { closed: "closed", stateChanged: "stateChanged" }, exportAs: ["brnDialog"], ngImport: i0, template: `
		<ng-content />
	`, isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush, encapsulation: i0.ViewEncapsulation.None }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.5", ngImport: i0, type: BrnDialogComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'brn-dialog',
                    standalone: true,
                    template: `
		<ng-content />
	`,
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    encapsulation: ViewEncapsulation.None,
                    exportAs: 'brnDialog',
                }]
        }], propDecorators: { closed: [{
                type: Output
            }], stateChanged: [{
                type: Output
            }], newState: [{
                type: Input,
                args: ['state']
            }], role: [{
                type: Input
            }], hasBackdrop: [{
                type: Input,
                args: [{ transform: booleanAttribute }]
            }], positionStrategy: [{
                type: Input
            }], scrollStrategy: [{
                type: Input
            }], restoreFocus: [{
                type: Input
            }], closeOnOutsidePointerEvents: [{
                type: Input,
                args: [{ transform: booleanAttribute }]
            }], closeOnBackdropClick: [{
                type: Input,
                args: [{ transform: booleanAttribute }]
            }], attachTo: [{
                type: Input
            }], attachPositions: [{
                type: Input
            }], autoFocus: [{
                type: Input
            }], closeDelay: [{
                type: Input,
                args: [{ transform: numberAttribute }]
            }], disableClose: [{
                type: Input,
                args: [{ transform: booleanAttribute }]
            }], ariaDescribedBy: [{
                type: Input,
                args: ['aria-describedby']
            }], ariaLabelledBy: [{
                type: Input,
                args: ['aria-labelledby']
            }], ariaLabel: [{
                type: Input,
                args: ['aria-label']
            }], ariaModal: [{
                type: Input,
                args: [{
                        alias: 'aria-modal',
                        transform: booleanAttribute,
                    }]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnJuLWRpYWxvZy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL3VpL2RpYWxvZy9icmFpbi9zcmMvbGliL2Jybi1kaWFsb2cuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFDTixzQkFBc0IsRUFDdEIscUJBQXFCLEdBS3JCLE1BQU0sc0JBQXNCLENBQUM7QUFDOUIsT0FBTyxFQUNOLHVCQUF1QixFQUN2QixTQUFTLEVBQ1QsWUFBWSxFQUNaLFFBQVEsRUFDUixLQUFLLEVBQ0wsTUFBTSxFQUNOLGdCQUFnQixFQUNoQixpQkFBaUIsRUFDakIsZ0JBQWdCLEVBQ2hCLFFBQVEsRUFDUixNQUFNLEVBQ04sTUFBTSxFQUNOLGVBQWUsRUFDZixxQkFBcUIsRUFDckIsTUFBTSxHQUlOLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDNUIsT0FBTyxFQUFFLDBCQUEwQixFQUF5QixNQUFNLHNCQUFzQixDQUFDO0FBR3pGLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDOztBQVl4RCxNQUFNLE9BQU8sa0JBQWtCO0lBVi9CO1FBV2tCLG1CQUFjLEdBQUcsTUFBTSxDQUFDLGdCQUFnQixDQUFDLENBQUM7UUFDMUMsU0FBSSxHQUFHLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQ2pDLG9CQUFlLEdBQUcsTUFBTSxDQUFDLHNCQUFzQixDQUFDLENBQUM7UUFDakQsU0FBSSxHQUFHLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1FBQ3BDLGNBQVMsR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7UUFFdEMsYUFBUSxHQUFHLEVBQUUsQ0FBQztRQUNaLGFBQVEsR0FBOEI7WUFDL0MsR0FBRywwQkFBMEI7U0FDN0IsQ0FBQztRQUdNLGVBQVUsR0FBRyxNQUFNLENBQTJC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RFgsS0FBSzt1QkFBQyxPQUFPO2dCQVdWLElBQUk7c0JBRFAsS0FBSztnQkFNRixXQUFXO3NCQURkLEtBQUs7dUJBQUMsRUFBRSxTQUFTLEVBQUUsZ0JBQWdCLEVBQUU7Z0JBTWxDLGdCQUFnQjtzQkFEbkIsS0FBSztnQkFNRixjQUFjO3NCQURqQixLQUFLO2dCQVlGLFlBQVk7c0JBRGYsS0FBSztnQkFNRiwyQkFBMkI7c0JBRDlCLEtBQUs7dUJBQUMsRUFBRSxTQUFTLEVBQUUsZ0JBQWdCLEVBQUU7Z0JBTWxDLG9CQUFvQjtzQkFEdkIsS0FBSzt1QkFBQyxFQUFFLFNBQVMsRUFBRSxnQkFBZ0IsRUFBRTtnQkFNbEMsUUFBUTtzQkFEWCxLQUFLO2dCQU1GLGVBQWU7c0JBRGxCLEtBQUs7Z0JBTUYsU0FBUztzQkFEWixLQUFLO2dCQU1GLFVBQVU7c0JBRGIsS0FBSzt1QkFBQyxFQUFFLFNBQVMsRUFBRSxlQUFlLEVBQUU7Z0JBTWpDLFlBQVk7c0JBRGYsS0FBSzt1QkFBQyxFQUFFLFNBQVMsRUFBRSxnQkFBZ0IsRUFBRTtnQkFPbEMsZUFBZTtzQkFEbEIsS0FBSzt1QkFBQyxrQkFBa0I7Z0JBT3JCLGNBQWM7c0JBRGpCLEtBQUs7dUJBQUMsaUJBQWlCO2dCQU9wQixTQUFTO3NCQURaLEtBQUs7dUJBQUMsWUFBWTtnQkFVZixTQUFTO3NCQUpaLEtBQUs7dUJBQUM7d0JBQ04sS0FBSyxFQUFFLFlBQVk7d0JBQ25CLFNBQVMsRUFBRSxnQkFBZ0I7cUJBQzNCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBBdXRvRm9jdXNUYXJnZXQgfSBmcm9tICdAYW5ndWxhci9jZGsvZGlhbG9nJztcbmltcG9ydCB7XG5cdE92ZXJsYXlQb3NpdGlvbkJ1aWxkZXIsXG5cdFNjcm9sbFN0cmF0ZWd5T3B0aW9ucyxcblx0dHlwZSBDb25uZWN0ZWRQb3NpdGlvbixcblx0dHlwZSBGbGV4aWJsZUNvbm5lY3RlZFBvc2l0aW9uU3RyYXRlZ3lPcmlnaW4sXG5cdHR5cGUgUG9zaXRpb25TdHJhdGVneSxcblx0dHlwZSBTY3JvbGxTdHJhdGVneSxcbn0gZnJvbSAnQGFuZ3VsYXIvY2RrL292ZXJsYXknO1xuaW1wb3J0IHtcblx0Q2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG5cdENvbXBvbmVudCxcblx0RXZlbnRFbWl0dGVyLFxuXHRJbmplY3Rvcixcblx0SW5wdXQsXG5cdE91dHB1dCxcblx0Vmlld0NvbnRhaW5lclJlZixcblx0Vmlld0VuY2Fwc3VsYXRpb24sXG5cdGJvb2xlYW5BdHRyaWJ1dGUsXG5cdGNvbXB1dGVkLFxuXHRlZmZlY3QsXG5cdGluamVjdCxcblx0bnVtYmVyQXR0cmlidXRlLFxuXHRydW5JbkluamVjdGlvbkNvbnRleHQsXG5cdHNpZ25hbCxcblx0dHlwZSBFZmZlY3RSZWYsXG5cdHR5cGUgRWxlbWVudFJlZixcblx0dHlwZSBUZW1wbGF0ZVJlZixcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyB0YWtlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBERUZBVUxUX0JSTl9ESUFMT0dfT1BUSU9OUywgdHlwZSBCcm5EaWFsb2dPcHRpb25zIH0gZnJvbSAnLi9icm4tZGlhbG9nLW9wdGlvbnMnO1xuaW1wb3J0IHR5cGUgeyBCcm5EaWFsb2dSZWYgfSBmcm9tICcuL2Jybi1kaWFsb2ctcmVmJztcbmltcG9ydCB0eXBlIHsgQnJuRGlhbG9nU3RhdGUgfSBmcm9tICcuL2Jybi1kaWFsb2ctc3RhdGUnO1xuaW1wb3J0IHsgQnJuRGlhbG9nU2VydmljZSB9IGZyb20gJy4vYnJuLWRpYWxvZy5zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG5cdHNlbGVjdG9yOiAnYnJuLWRpYWxvZycsXG5cdHN0YW5kYWxvbmU6IHRydWUsXG5cdHRlbXBsYXRlOiBgXG5cdFx0PG5nLWNvbnRlbnQgLz5cblx0YCxcblx0Y2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG5cdGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXG5cdGV4cG9ydEFzOiAnYnJuRGlhbG9nJyxcbn0pXG5leHBvcnQgY2xhc3MgQnJuRGlhbG9nQ29tcG9uZW50IHtcblx0cHJpdmF0ZSByZWFkb25seSBfZGlhbG9nU2VydmljZSA9IGluamVjdChCcm5EaWFsb2dTZXJ2aWNlKTtcblx0cHJpdmF0ZSByZWFkb25seSBfdmNyID0gaW5qZWN0KFZpZXdDb250YWluZXJSZWYpO1xuXHRwdWJsaWMgcmVhZG9ubHkgcG9zaXRpb25CdWlsZGVyID0gaW5qZWN0KE92ZXJsYXlQb3NpdGlvbkJ1aWxkZXIpO1xuXHRwdWJsaWMgcmVhZG9ubHkgc3NvcyA9IGluamVjdChTY3JvbGxTdHJhdGVneU9wdGlvbnMpO1xuXHRwcml2YXRlIHJlYWRvbmx5IF9pbmplY3RvciA9IGluamVjdChJbmplY3Rvcik7XG5cblx0cHJpdmF0ZSBfY29udGV4dCA9IHt9O1xuXHRwcm90ZWN0ZWQgX29wdGlvbnM6IFBhcnRpYWw8QnJuRGlhbG9nT3B0aW9ucz4gPSB7XG5cdFx0Li4uREVGQVVMVF9CUk5fRElBTE9HX09QVElPTlMsXG5cdH07XG5cblx0cHJpdmF0ZSBfY29udGVudFRlbXBsYXRlOiBUZW1wbGF0ZVJlZjx1bmtub3duPiB8IHVuZGVmaW5lZDtcblx0cHJpdmF0ZSBfZGlhbG9nUmVmID0gc2lnbmFsPEJybkRpYWxvZ1JlZiB8IHVuZGVmaW5lZD4odW5kZWZpbmVkKTtcblx0cHJpdmF0ZSBfZGlhbG9nU3RhdGVFZmZlY3RSZWY/OiBFZmZlY3RSZWY7XG5cblx0cHVibGljIHJlYWRvbmx5IHN0YXRlID0gY29tcHV0ZWQoKCkgPT4gdGhpcy5fZGlhbG9nUmVmKCk/LnN0YXRlKCkgPz8gJ2Nsb3NlZCcpO1xuXG5cdEBPdXRwdXQoKVxuXHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXHRwdWJsaWMgcmVhZG9ubHkgY2xvc2VkID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cblx0QE91dHB1dCgpXG5cdHB1YmxpYyByZWFkb25seSBzdGF0ZUNoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyPEJybkRpYWxvZ1N0YXRlPigpO1xuXG5cdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvbm8taW5wdXQtcmVuYW1lXG5cdEBJbnB1dCgnc3RhdGUnKVxuXHRzZXQgbmV3U3RhdGUoc3RhdGU6IEJybkRpYWxvZ1N0YXRlKSB7XG5cdFx0aWYgKHN0YXRlID09PSAnb3BlbicpIHtcblx0XHRcdHRoaXMub3BlbigpO1xuXHRcdH1cblx0XHRpZiAoc3RhdGUgPT09ICdjbG9zZWQnKSB7XG5cdFx0XHR0aGlzLmNsb3NlKHRoaXMuX29wdGlvbnNbJ2Nsb3NlRGVsYXknXSk7XG5cdFx0fVxuXHR9XG5cblx0QElucHV0KClcblx0c2V0IHJvbGUocm9sZTogJ2RpYWxvZycgfCAnYWxlcnRkaWFsb2cnKSB7XG5cdFx0dGhpcy5fb3B0aW9uc1sncm9sZSddID0gcm9sZTtcblx0fVxuXG5cdEBJbnB1dCh7IHRyYW5zZm9ybTogYm9vbGVhbkF0dHJpYnV0ZSB9KVxuXHRzZXQgaGFzQmFja2Ryb3AoaGFzQmFja2Ryb3A6IGJvb2xlYW4pIHtcblx0XHR0aGlzLl9vcHRpb25zWydoYXNCYWNrZHJvcCddID0gaGFzQmFja2Ryb3A7XG5cdH1cblxuXHRASW5wdXQoKVxuXHRzZXQgcG9zaXRpb25TdHJhdGVneShwb3NpdGlvblN0cmF0ZWd5OiBQb3NpdGlvblN0cmF0ZWd5KSB7XG5cdFx0dGhpcy5fb3B0aW9uc1sncG9zaXRpb25TdHJhdGVneSddID0gcG9zaXRpb25TdHJhdGVneTtcblx0fVxuXG5cdEBJbnB1dCgpXG5cdHNldCBzY3JvbGxTdHJhdGVneShzY3JvbGxTdHJhdGVneTogU2Nyb2xsU3RyYXRlZ3kgfCAnY2xvc2UnIHwgJ3JlcG9zaXRpb24nKSB7XG5cdFx0aWYgKHNjcm9sbFN0cmF0ZWd5ID09PSAnY2xvc2UnKSB7XG5cdFx0XHR0aGlzLl9vcHRpb25zWydzY3JvbGxTdHJhdGVneSddID0gdGhpcy5zc29zLmNsb3NlKCk7XG5cdFx0fSBlbHNlIGlmIChzY3JvbGxTdHJhdGVneSA9PT0gJ3JlcG9zaXRpb24nKSB7XG5cdFx0XHR0aGlzLl9vcHRpb25zWydzY3JvbGxTdHJhdGVneSddID0gdGhpcy5zc29zLnJlcG9zaXRpb24oKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5fb3B0aW9uc1snc2Nyb2xsU3RyYXRlZ3knXSA9IHNjcm9sbFN0cmF0ZWd5O1xuXHRcdH1cblx0fVxuXG5cdEBJbnB1dCgpXG5cdHNldCByZXN0b3JlRm9jdXMocmVzdG9yZUZvY3VzOiBib29sZWFuIHwgc3RyaW5nIHwgRWxlbWVudFJlZikge1xuXHRcdHRoaXMuX29wdGlvbnNbJ3Jlc3RvcmVGb2N1cyddID0gcmVzdG9yZUZvY3VzO1xuXHR9XG5cblx0QElucHV0KHsgdHJhbnNmb3JtOiBib29sZWFuQXR0cmlidXRlIH0pXG5cdHNldCBjbG9zZU9uT3V0c2lkZVBvaW50ZXJFdmVudHMoY2xvc2VPbk91dHNpZGVQb2ludGVyRXZlbnRzOiBib29sZWFuKSB7XG5cdFx0dGhpcy5fb3B0aW9uc1snY2xvc2VPbk91dHNpZGVQb2ludGVyRXZlbnRzJ10gPSBjbG9zZU9uT3V0c2lkZVBvaW50ZXJFdmVudHM7XG5cdH1cblxuXHRASW5wdXQoeyB0cmFuc2Zvcm06IGJvb2xlYW5BdHRyaWJ1dGUgfSlcblx0c2V0IGNsb3NlT25CYWNrZHJvcENsaWNrKGNsb3NlT25CYWNrZHJvcENsaWNrOiBib29sZWFuKSB7XG5cdFx0dGhpcy5fb3B0aW9uc1snY2xvc2VPbkJhY2tkcm9wQ2xpY2snXSA9IGNsb3NlT25CYWNrZHJvcENsaWNrO1xuXHR9XG5cblx0QElucHV0KClcblx0c2V0IGF0dGFjaFRvKGF0dGFjaFRvOiBGbGV4aWJsZUNvbm5lY3RlZFBvc2l0aW9uU3RyYXRlZ3lPcmlnaW4gfCBudWxsIHwgdW5kZWZpbmVkKSB7XG5cdFx0dGhpcy5fb3B0aW9uc1snYXR0YWNoVG8nXSA9IGF0dGFjaFRvO1xuXHR9XG5cblx0QElucHV0KClcblx0c2V0IGF0dGFjaFBvc2l0aW9ucyhhdHRhY2hQb3NpdGlvbnM6IENvbm5lY3RlZFBvc2l0aW9uW10pIHtcblx0XHR0aGlzLl9vcHRpb25zWydhdHRhY2hQb3NpdGlvbnMnXSA9IGF0dGFjaFBvc2l0aW9ucztcblx0fVxuXG5cdEBJbnB1dCgpXG5cdHNldCBhdXRvRm9jdXMoYXV0b0ZvY3VzOiBBdXRvRm9jdXNUYXJnZXQgfCBzdHJpbmcpIHtcblx0XHR0aGlzLl9vcHRpb25zWydhdXRvRm9jdXMnXSA9IGF1dG9Gb2N1cztcblx0fVxuXG5cdEBJbnB1dCh7IHRyYW5zZm9ybTogbnVtYmVyQXR0cmlidXRlIH0pXG5cdHNldCBjbG9zZURlbGF5KGNsb3NlRGVsYXk6IG51bWJlcikge1xuXHRcdHRoaXMuX29wdGlvbnNbJ2Nsb3NlRGVsYXknXSA9IGNsb3NlRGVsYXk7XG5cdH1cblxuXHRASW5wdXQoeyB0cmFuc2Zvcm06IGJvb2xlYW5BdHRyaWJ1dGUgfSlcblx0c2V0IGRpc2FibGVDbG9zZShkaXNhYmxlQ2xvc2U6IGJvb2xlYW4pIHtcblx0XHR0aGlzLl9vcHRpb25zWydkaXNhYmxlQ2xvc2UnXSA9IGRpc2FibGVDbG9zZTtcblx0fVxuXG5cdC8qIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvbm8taW5wdXQtcmVuYW1lICovXG5cdEBJbnB1dCgnYXJpYS1kZXNjcmliZWRieScpXG5cdHNldCBhcmlhRGVzY3JpYmVkQnkoYXJpYURlc2NyaWJlZEJ5OiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkKSB7XG5cdFx0dGhpcy5zZXRBcmlhRGVzY3JpYmVkQnkoYXJpYURlc2NyaWJlZEJ5KTtcblx0fVxuXG5cdC8qIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvbm8taW5wdXQtcmVuYW1lICovXG5cdEBJbnB1dCgnYXJpYS1sYWJlbGxlZGJ5Jylcblx0c2V0IGFyaWFMYWJlbGxlZEJ5KGFyaWFMYWJlbGxlZEJ5OiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkKSB7XG5cdFx0dGhpcy5zZXRBcmlhTGFiZWxsZWRCeShhcmlhTGFiZWxsZWRCeSk7XG5cdH1cblxuXHQvKiBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQGFuZ3VsYXItZXNsaW50L25vLWlucHV0LXJlbmFtZSAqL1xuXHRASW5wdXQoJ2FyaWEtbGFiZWwnKVxuXHRzZXQgYXJpYUxhYmVsKGFyaWFMYWJlbDogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCkge1xuXHRcdHRoaXMuc2V0QXJpYUxhYmVsKGFyaWFMYWJlbCk7XG5cdH1cblxuXHQvKiBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQGFuZ3VsYXItZXNsaW50L25vLWlucHV0LXJlbmFtZSAqL1xuXHRASW5wdXQoe1xuXHRcdGFsaWFzOiAnYXJpYS1tb2RhbCcsXG5cdFx0dHJhbnNmb3JtOiBib29sZWFuQXR0cmlidXRlLFxuXHR9KVxuXHRzZXQgYXJpYU1vZGFsKGlzTW9kYWw6IGJvb2xlYW4pIHtcblx0XHR0aGlzLnNldEFyaWFNb2RhbChpc01vZGFsKTtcblx0fVxuXG5cdHB1YmxpYyBvcGVuPERpYWxvZ0NvbnRleHQ+KCkge1xuXHRcdGlmICghdGhpcy5fY29udGVudFRlbXBsYXRlIHx8IHRoaXMuX2RpYWxvZ1JlZigpKSByZXR1cm47XG5cblx0XHR0aGlzLl9kaWFsb2dTdGF0ZUVmZmVjdFJlZj8uZGVzdHJveSgpO1xuXG5cdFx0Y29uc3QgZGlhbG9nUmVmID0gdGhpcy5fZGlhbG9nU2VydmljZS5vcGVuPERpYWxvZ0NvbnRleHQ+KFxuXHRcdFx0dGhpcy5fY29udGVudFRlbXBsYXRlLFxuXHRcdFx0dGhpcy5fdmNyLFxuXHRcdFx0dGhpcy5fY29udGV4dCBhcyBEaWFsb2dDb250ZXh0LFxuXHRcdFx0dGhpcy5fb3B0aW9ucyxcblx0XHQpO1xuXG5cdFx0dGhpcy5fZGlhbG9nUmVmLnNldChkaWFsb2dSZWYpO1xuXG5cdFx0cnVuSW5JbmplY3Rpb25Db250ZXh0KHRoaXMuX2luamVjdG9yLCAoKSA9PiB7XG5cdFx0XHR0aGlzLl9kaWFsb2dTdGF0ZUVmZmVjdFJlZiA9IGVmZmVjdCgoKSA9PiB0aGlzLnN0YXRlQ2hhbmdlZC5lbWl0KGRpYWxvZ1JlZi5zdGF0ZSgpKSk7XG5cdFx0fSk7XG5cblx0XHRkaWFsb2dSZWYuY2xvc2VkJC5waXBlKHRha2UoMSkpLnN1YnNjcmliZSgocmVzdWx0KSA9PiB7XG5cdFx0XHR0aGlzLl9kaWFsb2dSZWYuc2V0KHVuZGVmaW5lZCk7XG5cdFx0XHR0aGlzLmNsb3NlZC5lbWl0KHJlc3VsdCk7XG5cdFx0fSk7XG5cdH1cblxuXHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuXHRwdWJsaWMgY2xvc2UocmVzdWx0OiBhbnksIGRlbGF5PzogbnVtYmVyKSB7XG5cdFx0dGhpcy5fZGlhbG9nUmVmKCk/LmNsb3NlKHJlc3VsdCwgZGVsYXkgPz8gdGhpcy5fb3B0aW9ucy5jbG9zZURlbGF5KTtcblx0fVxuXG5cdHB1YmxpYyByZWdpc3RlclRlbXBsYXRlKHRlbXBsYXRlOiBUZW1wbGF0ZVJlZjx1bmtub3duPikge1xuXHRcdHRoaXMuX2NvbnRlbnRUZW1wbGF0ZSA9IHRlbXBsYXRlO1xuXHR9XG5cblx0cHVibGljIHNldE92ZXJsYXlDbGFzcyhvdmVybGF5Q2xhc3M6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQpIHtcblx0XHR0aGlzLl9vcHRpb25zWydiYWNrZHJvcENsYXNzJ10gPSBvdmVybGF5Q2xhc3MgPz8gJyc7XG5cdFx0dGhpcy5fZGlhbG9nUmVmKCk/LnNldE92ZXJsYXlDbGFzcyhvdmVybGF5Q2xhc3MpO1xuXHR9XG5cblx0cHVibGljIHNldFBhbmVsQ2xhc3MocGFuZWxDbGFzczogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCkge1xuXHRcdHRoaXMuX29wdGlvbnNbJ3BhbmVsQ2xhc3MnXSA9IHBhbmVsQ2xhc3MgPz8gJyc7XG5cdFx0dGhpcy5fZGlhbG9nUmVmKCk/LnNldFBhbmVsQ2xhc3MocGFuZWxDbGFzcyk7XG5cdH1cblxuXHRwdWJsaWMgc2V0Q29udGV4dChjb250ZXh0OiB1bmtub3duKSB7XG5cdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudFxuXHRcdC8vIEB0cy1leHBlY3QtZXJyb3Jcblx0XHR0aGlzLl9jb250ZXh0ID0geyAuLi50aGlzLl9jb250ZXh0LCAuLi5jb250ZXh0IH07XG5cdH1cblxuXHRwdWJsaWMgc2V0QXJpYURlc2NyaWJlZEJ5KGFyaWFEZXNjcmliZWRCeTogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCkge1xuXHRcdHRoaXMuX29wdGlvbnMgPSB7IC4uLnRoaXMuX29wdGlvbnMsIGFyaWFEZXNjcmliZWRCeSB9O1xuXHRcdHRoaXMuX2RpYWxvZ1JlZigpPy5zZXRBcmlhRGVzY3JpYmVkQnkoYXJpYURlc2NyaWJlZEJ5KTtcblx0fVxuXG5cdHB1YmxpYyBzZXRBcmlhTGFiZWxsZWRCeShhcmlhTGFiZWxsZWRCeTogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCkge1xuXHRcdHRoaXMuX29wdGlvbnMgPSB7IC4uLnRoaXMuX29wdGlvbnMsIGFyaWFMYWJlbGxlZEJ5IH07XG5cdFx0dGhpcy5fZGlhbG9nUmVmKCk/LnNldEFyaWFMYWJlbGxlZEJ5KGFyaWFMYWJlbGxlZEJ5KTtcblx0fVxuXG5cdHB1YmxpYyBzZXRBcmlhTGFiZWwoYXJpYUxhYmVsOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkKSB7XG5cdFx0dGhpcy5fb3B0aW9ucyA9IHsgLi4udGhpcy5fb3B0aW9ucywgYXJpYUxhYmVsIH07XG5cdFx0dGhpcy5fZGlhbG9nUmVmKCk/LnNldEFyaWFMYWJlbChhcmlhTGFiZWwpO1xuXHR9XG5cblx0cHVibGljIHNldEFyaWFNb2RhbChhcmlhTW9kYWw6IGJvb2xlYW4pIHtcblx0XHR0aGlzLl9vcHRpb25zID0geyAuLi50aGlzLl9vcHRpb25zLCBhcmlhTW9kYWwgfTtcblx0fVxufVxuIl19