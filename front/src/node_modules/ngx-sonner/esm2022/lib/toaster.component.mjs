import { isPlatformBrowser } from '@angular/common';
import { booleanAttribute, ChangeDetectionStrategy, Component, computed, effect, ElementRef, inject, input, numberAttribute, PLATFORM_ID, signal, untracked, ViewChild, ViewEncapsulation, } from '@angular/core';
import { IconComponent } from './icon.component';
import { LoaderComponent } from './loader.component';
import { ToastPositionPipe } from './pipes/toast-position.pipe';
import { toastState } from './state';
import { ToastComponent } from './toast.component';
import * as i0 from "@angular/core";
// Default lifetime of a toasts (in ms)
const TOAST_LIFETIME = 4000;
// Visible toasts amount
const VISIBLE_TOASTS_AMOUNT = 3;
// Viewport padding
const VIEWPORT_OFFSET = '32px';
// Default toast width
const TOAST_WIDTH = 356;
// Default gap between toasts
const GAP = 14;
// eslint-disable-next-line @angular-eslint/component-class-suffix
export class NgxSonnerToaster {
    constructor() {
        this.platformId = inject(PLATFORM_ID);
        this.toasts = toastState.toasts;
        this.heights = toastState.heights;
        this.reset = toastState.reset;
        this.invert = input(false, {
            transform: booleanAttribute,
        });
        this.theme = input('light');
        this.position = input('bottom-right');
        this.hotKey = input(['altKey', 'KeyT']);
        this.richColors = input(false, {
            transform: booleanAttribute,
        });
        this.expand = input(false, {
            transform: booleanAttribute,
        });
        this.duration = input(TOAST_LIFETIME, {
            transform: numberAttribute,
        });
        this.visibleToasts = input(VISIBLE_TOASTS_AMOUNT, { transform: numberAttribute });
        this.closeButton = input(false, {
            transform: booleanAttribute,
        });
        this.toastOptions = input({});
        this.offset = input(null);
        this.dir = input(this.getDocumentDirection());
        this._class = input('', { alias: 'class' });
        this._style = input({}, { alias: 'style' });
        this.possiblePositions = computed(() => Array.from(new Set([
            this.position(),
            ...this.toasts()
                .filter(toast => toast.position)
                .map(toast => toast.position),
        ].filter(Boolean))));
        this.expanded = signal(false);
        this.interacting = signal(false);
        this.actualTheme = signal(this.getActualTheme(this.theme()));
        this.lastFocusedElementRef = signal(null);
        this.isFocusWithinRef = signal(false);
        this.hotKeyLabel = computed(() => this.hotKey().join('+').replace(/Key/g, '').replace(/Digit/g, ''));
        this.toasterStyles = computed(() => ({
            '--front-toast-height': `${this.heights()[0]?.height}px`,
            '--offset': typeof this.offset() === 'number'
                ? `${this.offset()}px`
                : this.offset() ?? `${VIEWPORT_OFFSET}`,
            '--width': `${TOAST_WIDTH}px`,
            '--gap': `${GAP}px`,
            ...this._style(),
        }));
        this.handleKeydown = (event) => {
            if (!this.listRef?.nativeElement)
                return;
            const isHotkeyPressed = this.hotKey().every(key => event[key] || event.code === key);
            if (isHotkeyPressed) {
                this.expanded.set(true);
                this.listRef.nativeElement?.focus();
            }
            if (event.code === 'Escape' &&
                (document.activeElement === this.listRef.nativeElement ||
                    this.listRef.nativeElement?.contains(document.activeElement))) {
                this.expanded.set(false);
            }
        };
        this.handleThemePreferenceChange = ({ matches }) => {
            if (this.theme() === 'system') {
                this.actualTheme.set(matches ? 'dark' : 'light');
            }
        };
        this.reset();
        document.addEventListener('keydown', this.handleKeydown);
        if (isPlatformBrowser(this.platformId)) {
            window
                .matchMedia('(prefers-color-scheme: dark)')
                .addEventListener('change', this.handleThemePreferenceChange);
        }
        effect(() => {
            if (this.toasts().length >= 1) {
                untracked(() => this.expanded.set(false));
            }
        });
        effect(() => {
            const theme = this.theme();
            untracked(() => this.actualTheme.set(this.getActualTheme(theme)));
        });
    }
    ngOnDestroy() {
        document.removeEventListener('keydown', this.handleKeydown);
        if (isPlatformBrowser(this.platformId)) {
            window
                .matchMedia('(prefers-color-scheme: dark)')
                .removeEventListener('change', this.handleThemePreferenceChange);
        }
    }
    handleBlur(event) {
        if (this.isFocusWithinRef() &&
            !event.target.contains(event.relatedTarget)) {
            this.isFocusWithinRef.set(false);
            if (this.lastFocusedElementRef()) {
                this.lastFocusedElementRef()?.focus({ preventScroll: true });
                this.lastFocusedElementRef.set(null);
            }
        }
    }
    handleFocus(event) {
        if (!this.isFocusWithinRef()) {
            this.isFocusWithinRef.set(true);
            this.lastFocusedElementRef.set(event.relatedTarget);
        }
    }
    handleMouseLeave() {
        if (!this.interacting()) {
            this.expanded.set(false);
        }
    }
    getActualTheme(t) {
        if (t !== 'system') {
            return t;
        }
        if (isPlatformBrowser(this.platformId)) {
            if (window.matchMedia &&
                window.matchMedia('(prefers-color-scheme: dark)').matches) {
                return 'dark';
            }
            return 'light';
        }
        return 'light';
    }
    getDocumentDirection() {
        if (typeof window === 'undefined')
            return 'ltr';
        if (typeof document === 'undefined')
            return 'ltr'; // For Fresh purpose
        const dirAttribute = document.documentElement.getAttribute('dir');
        if (dirAttribute === 'auto' || !dirAttribute) {
            return window.getComputedStyle(document.documentElement)
                .direction;
        }
        return dirAttribute;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.1.3", ngImport: i0, type: NgxSonnerToaster, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "17.1.3", type: NgxSonnerToaster, isStandalone: true, selector: "ngx-sonner-toaster", inputs: { invert: { classPropertyName: "invert", publicName: "invert", isSignal: true, isRequired: false, transformFunction: null }, theme: { classPropertyName: "theme", publicName: "theme", isSignal: true, isRequired: false, transformFunction: null }, position: { classPropertyName: "position", publicName: "position", isSignal: true, isRequired: false, transformFunction: null }, hotKey: { classPropertyName: "hotKey", publicName: "hotKey", isSignal: true, isRequired: false, transformFunction: null }, richColors: { classPropertyName: "richColors", publicName: "richColors", isSignal: true, isRequired: false, transformFunction: null }, expand: { classPropertyName: "expand", publicName: "expand", isSignal: true, isRequired: false, transformFunction: null }, duration: { classPropertyName: "duration", publicName: "duration", isSignal: true, isRequired: false, transformFunction: null }, visibleToasts: { classPropertyName: "visibleToasts", publicName: "visibleToasts", isSignal: true, isRequired: false, transformFunction: null }, closeButton: { classPropertyName: "closeButton", publicName: "closeButton", isSignal: true, isRequired: false, transformFunction: null }, toastOptions: { classPropertyName: "toastOptions", publicName: "toastOptions", isSignal: true, isRequired: false, transformFunction: null }, offset: { classPropertyName: "offset", publicName: "offset", isSignal: true, isRequired: false, transformFunction: null }, dir: { classPropertyName: "dir", publicName: "dir", isSignal: true, isRequired: false, transformFunction: null }, _class: { classPropertyName: "_class", publicName: "class", isSignal: true, isRequired: false, transformFunction: null }, _style: { classPropertyName: "_style", publicName: "style", isSignal: true, isRequired: false, transformFunction: null } }, viewQueries: [{ propertyName: "listRef", first: true, predicate: ["listRef"], descendants: true }], ngImport: i0, template: `
    @if (toasts().length > 0) {
      <section
        [attr.aria-label]="'Notifications ' + hotKeyLabel()"
        [tabIndex]="-1">
        @for (pos of possiblePositions(); track pos) {
          <ol
            #listRef
            [tabIndex]="-1"
            [class]="_class()"
            data-sonner-toaster
            [attr.data-theme]="actualTheme()"
            [attr.data-rich-colors]="richColors()"
            [attr.dir]="dir() === 'auto' ? getDocumentDirection() : dir()"
            [attr.data-y-position]="pos.split('-')[0]"
            [attr.data-x-position]="pos.split('-')[1]"
            (blur)="handleBlur($event)"
            (focus)="handleFocus($event)"
            (mouseenter)="expanded.set(true)"
            (mousemove)="expanded.set(true)"
            (mouseleave)="handleMouseLeave()"
            (pointerdown)="interacting.set(true)"
            (pointerup)="interacting.set(false)"
            [style]="toasterStyles()">
            @for (
              toast of toasts() | toastPosition: $index : pos;
              track toast.id
            ) {
              <ngx-sonner-toast
                [index]="$index"
                [toast]="toast"
                [invert]="invert()"
                [visibleToasts]="visibleToasts()"
                [closeButton]="closeButton()"
                [interacting]="interacting()"
                [position]="position()"
                [expandByDefault]="expand()"
                [expanded]="expanded()"
                [actionButtonStyle]="toastOptions().actionButtonStyle"
                [cancelButtonStyle]="toastOptions().cancelButtonStyle"
                [class]="toastOptions().class ?? ''"
                [descriptionClass]="toastOptions().descriptionClass ?? ''"
                [classes]="toastOptions().classes ?? {}"
                [duration]="toastOptions().duration ?? duration()"
                [unstyled]="toastOptions().unstyled ?? false">
                <ngx-sonner-loader
                  [isVisible]="toast.type === 'loading'"
                  loading-icon />
                <ngx-sonner-icon type="success" success-icon />
                <ngx-sonner-icon type="error" error-icon />
                <ngx-sonner-icon type="warning" warning-icon />
                <ngx-sonner-icon type="info" info-icon />
              </ngx-sonner-toast>
            }
          </ol>
        }
      </section>
    }
  `, isInline: true, styles: ["html[dir=ltr],[data-sonner-toaster][dir=ltr]{--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}html[dir=rtl],[data-sonner-toaster][dir=rtl]{--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}[data-sonner-toaster][data-x-position=right]{right:max(var(--offset),env(safe-area-inset-right))}[data-sonner-toaster][data-x-position=left]{left:max(var(--offset),env(safe-area-inset-left))}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translate(-50%)}[data-sonner-toaster][data-y-position=top]{top:max(var(--offset),env(safe-area-inset-top))}[data-sonner-toaster][data-y-position=bottom]{bottom:max(var(--offset),env(safe-area-inset-bottom))}[data-sonner-toast]{--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}[data-sonner-toast][data-y-position=top]{top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}[data-sonner-toast] [data-description]{font-weight:400;line-height:1.4;color:inherit}[data-sonner-toast] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast] [data-icon]>*{flex-shrink:0}[data-sonner-toast] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast] [data-button]:focus-visible{box-shadow:0 0 0 2px #0006}[data-sonner-toast] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast] [data-cancel]{color:var(--normal-text);background:#00000014}[data-sonner-toast][data-theme=dark] [data-cancel]{background:#ffffff4d}[data-sonner-toast] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]:focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}[data-sonner-toast] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]:before{content:\"\";position:absolute;left:0;right:0;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]:before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]:before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]:before{content:\"\";position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast]:after{content:\"\";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y: translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y: translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]:before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - 32px)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true] [data-sonner-toast][data-type=success],[data-rich-colors=true] [data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true] [data-sonner-toast][data-type=info],[data-rich-colors=true] [data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true] [data-sonner-toast][data-type=warning],[data-rich-colors=true] [data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true] [data-sonner-toast][data-type=error],[data-rich-colors=true] [data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}\n"], dependencies: [{ kind: "component", type: ToastComponent, selector: "ngx-sonner-toast", inputs: ["toast", "index", "expanded", "invert", "position", "visibleToasts", "expandByDefault", "closeButton", "interacting", "cancelButtonStyle", "actionButtonStyle", "duration", "descriptionClass", "classes", "unstyled", "class", "style"] }, { kind: "pipe", type: ToastPositionPipe, name: "toastPosition" }, { kind: "component", type: IconComponent, selector: "ngx-sonner-icon", inputs: ["type"] }, { kind: "component", type: LoaderComponent, selector: "ngx-sonner-loader", inputs: ["isVisible"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush, encapsulation: i0.ViewEncapsulation.None }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.1.3", ngImport: i0, type: NgxSonnerToaster, decorators: [{
            type: Component,
            args: [{ selector: 'ngx-sonner-toaster', standalone: true, imports: [ToastComponent, ToastPositionPipe, IconComponent, LoaderComponent], template: `
    @if (toasts().length > 0) {
      <section
        [attr.aria-label]="'Notifications ' + hotKeyLabel()"
        [tabIndex]="-1">
        @for (pos of possiblePositions(); track pos) {
          <ol
            #listRef
            [tabIndex]="-1"
            [class]="_class()"
            data-sonner-toaster
            [attr.data-theme]="actualTheme()"
            [attr.data-rich-colors]="richColors()"
            [attr.dir]="dir() === 'auto' ? getDocumentDirection() : dir()"
            [attr.data-y-position]="pos.split('-')[0]"
            [attr.data-x-position]="pos.split('-')[1]"
            (blur)="handleBlur($event)"
            (focus)="handleFocus($event)"
            (mouseenter)="expanded.set(true)"
            (mousemove)="expanded.set(true)"
            (mouseleave)="handleMouseLeave()"
            (pointerdown)="interacting.set(true)"
            (pointerup)="interacting.set(false)"
            [style]="toasterStyles()">
            @for (
              toast of toasts() | toastPosition: $index : pos;
              track toast.id
            ) {
              <ngx-sonner-toast
                [index]="$index"
                [toast]="toast"
                [invert]="invert()"
                [visibleToasts]="visibleToasts()"
                [closeButton]="closeButton()"
                [interacting]="interacting()"
                [position]="position()"
                [expandByDefault]="expand()"
                [expanded]="expanded()"
                [actionButtonStyle]="toastOptions().actionButtonStyle"
                [cancelButtonStyle]="toastOptions().cancelButtonStyle"
                [class]="toastOptions().class ?? ''"
                [descriptionClass]="toastOptions().descriptionClass ?? ''"
                [classes]="toastOptions().classes ?? {}"
                [duration]="toastOptions().duration ?? duration()"
                [unstyled]="toastOptions().unstyled ?? false">
                <ngx-sonner-loader
                  [isVisible]="toast.type === 'loading'"
                  loading-icon />
                <ngx-sonner-icon type="success" success-icon />
                <ngx-sonner-icon type="error" error-icon />
                <ngx-sonner-icon type="warning" warning-icon />
                <ngx-sonner-icon type="info" info-icon />
              </ngx-sonner-toast>
            }
          </ol>
        }
      </section>
    }
  `, encapsulation: ViewEncapsulation.None, changeDetection: ChangeDetectionStrategy.OnPush, styles: ["html[dir=ltr],[data-sonner-toaster][dir=ltr]{--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}html[dir=rtl],[data-sonner-toaster][dir=rtl]{--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}[data-sonner-toaster][data-x-position=right]{right:max(var(--offset),env(safe-area-inset-right))}[data-sonner-toaster][data-x-position=left]{left:max(var(--offset),env(safe-area-inset-left))}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translate(-50%)}[data-sonner-toaster][data-y-position=top]{top:max(var(--offset),env(safe-area-inset-top))}[data-sonner-toaster][data-y-position=bottom]{bottom:max(var(--offset),env(safe-area-inset-bottom))}[data-sonner-toast]{--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}[data-sonner-toast][data-y-position=top]{top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}[data-sonner-toast] [data-description]{font-weight:400;line-height:1.4;color:inherit}[data-sonner-toast] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast] [data-icon]>*{flex-shrink:0}[data-sonner-toast] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast] [data-button]:focus-visible{box-shadow:0 0 0 2px #0006}[data-sonner-toast] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast] [data-cancel]{color:var(--normal-text);background:#00000014}[data-sonner-toast][data-theme=dark] [data-cancel]{background:#ffffff4d}[data-sonner-toast] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]:focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}[data-sonner-toast] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]:before{content:\"\";position:absolute;left:0;right:0;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]:before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]:before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]:before{content:\"\";position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast]:after{content:\"\";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y: translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y: translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]:before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - 32px)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true] [data-sonner-toast][data-type=success],[data-rich-colors=true] [data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true] [data-sonner-toast][data-type=info],[data-rich-colors=true] [data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true] [data-sonner-toast][data-type=warning],[data-rich-colors=true] [data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true] [data-sonner-toast][data-type=error],[data-rich-colors=true] [data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}\n"] }]
        }], ctorParameters: () => [], propDecorators: { listRef: [{
                type: ViewChild,
                args: ['listRef']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9hc3Rlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9saWJzL25neC1zb25uZXIvc3JjL2xpYi90b2FzdGVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUNwRCxPQUFPLEVBQ0wsZ0JBQWdCLEVBQ2hCLHVCQUF1QixFQUN2QixTQUFTLEVBQ1QsUUFBUSxFQUNSLE1BQU0sRUFDTixVQUFVLEVBQ1YsTUFBTSxFQUNOLEtBQUssRUFDTCxlQUFlLEVBRWYsV0FBVyxFQUNYLE1BQU0sRUFDTixTQUFTLEVBQ1QsU0FBUyxFQUNULGlCQUFpQixHQUNsQixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDakQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3JELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFDckMsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG1CQUFtQixDQUFDOztBQUduRCx1Q0FBdUM7QUFDdkMsTUFBTSxjQUFjLEdBQUcsSUFBSSxDQUFDO0FBRTVCLHdCQUF3QjtBQUN4QixNQUFNLHFCQUFxQixHQUFHLENBQUMsQ0FBQztBQUVoQyxtQkFBbUI7QUFDbkIsTUFBTSxlQUFlLEdBQUcsTUFBTSxDQUFDO0FBRS9CLHNCQUFzQjtBQUN0QixNQUFNLFdBQVcsR0FBRyxHQUFHLENBQUM7QUFFeEIsNkJBQTZCO0FBQzdCLE1BQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQztBQXFFZixrRUFBa0U7QUFDbEUsTUFBTSxPQUFPLGdCQUFnQjtJQXlFM0I7UUF4RWlCLGVBQVUsR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLENB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QjtrQkFwRTVCLFNBQVM7K0JBQ0Usb0JBQW9CLGNBQ2xCLElBQUksV0FDUCxDQUFDLGNBQWMsRUFBRSxpQkFBaUIsRUFBRSxhQUFhLEVBQUUsZUFBZSxDQUFDLFlBQ2xFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBMERULGlCQUVjLGlCQUFpQixDQUFDLElBQUksbUJBQ3BCLHVCQUF1QixDQUFDLE1BQU07d0RBeUR6QixPQUFPO3NCQUE1QixTQUFTO3VCQUFDLFNBQVMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc1BsYXRmb3JtQnJvd3NlciB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQge1xuICBib29sZWFuQXR0cmlidXRlLFxuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgQ29tcG9uZW50LFxuICBjb21wdXRlZCxcbiAgZWZmZWN0LFxuICBFbGVtZW50UmVmLFxuICBpbmplY3QsXG4gIGlucHV0LFxuICBudW1iZXJBdHRyaWJ1dGUsXG4gIE9uRGVzdHJveSxcbiAgUExBVEZPUk1fSUQsXG4gIHNpZ25hbCxcbiAgdW50cmFja2VkLFxuICBWaWV3Q2hpbGQsXG4gIFZpZXdFbmNhcHN1bGF0aW9uLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEljb25Db21wb25lbnQgfSBmcm9tICcuL2ljb24uY29tcG9uZW50JztcbmltcG9ydCB7IExvYWRlckNvbXBvbmVudCB9IGZyb20gJy4vbG9hZGVyLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBUb2FzdFBvc2l0aW9uUGlwZSB9IGZyb20gJy4vcGlwZXMvdG9hc3QtcG9zaXRpb24ucGlwZSc7XG5pbXBvcnQgeyB0b2FzdFN0YXRlIH0gZnJvbSAnLi9zdGF0ZSc7XG5pbXBvcnQgeyBUb2FzdENvbXBvbmVudCB9IGZyb20gJy4vdG9hc3QuY29tcG9uZW50JztcbmltcG9ydCB7IFBvc2l0aW9uLCBUaGVtZSwgVG9hc3RlclByb3BzIH0gZnJvbSAnLi90eXBlcyc7XG5cbi8vIERlZmF1bHQgbGlmZXRpbWUgb2YgYSB0b2FzdHMgKGluIG1zKVxuY29uc3QgVE9BU1RfTElGRVRJTUUgPSA0MDAwO1xuXG4vLyBWaXNpYmxlIHRvYXN0cyBhbW91bnRcbmNvbnN0IFZJU0lCTEVfVE9BU1RTX0FNT1VOVCA9IDM7XG5cbi8vIFZpZXdwb3J0IHBhZGRpbmdcbmNvbnN0IFZJRVdQT1JUX09GRlNFVCA9ICczMnB4JztcblxuLy8gRGVmYXVsdCB0b2FzdCB3aWR0aFxuY29uc3QgVE9BU1RfV0lEVEggPSAzNTY7XG5cbi8vIERlZmF1bHQgZ2FwIGJldHdlZW4gdG9hc3RzXG5jb25zdCBHQVAgPSAxNDtcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmd4LXNvbm5lci10b2FzdGVyJyxcbiAgc3RhbmRhbG9uZTogdHJ1ZSxcbiAgaW1wb3J0czogW1RvYXN0Q29tcG9uZW50LCBUb2FzdFBvc2l0aW9uUGlwZSwgSWNvbkNvbXBvbmVudCwgTG9hZGVyQ29tcG9uZW50XSxcbiAgdGVtcGxhdGU6IGBcbiAgICBAaWYgKHRvYXN0cygpLmxlbmd0aCA+IDApIHtcbiAgICAgIDxzZWN0aW9uXG4gICAgICAgIFthdHRyLmFyaWEtbGFiZWxdPVwiJ05vdGlmaWNhdGlvbnMgJyArIGhvdEtleUxhYmVsKClcIlxuICAgICAgICBbdGFiSW5kZXhdPVwiLTFcIj5cbiAgICAgICAgQGZvciAocG9zIG9mIHBvc3NpYmxlUG9zaXRpb25zKCk7IHRyYWNrIHBvcykge1xuICAgICAgICAgIDxvbFxuICAgICAgICAgICAgI2xpc3RSZWZcbiAgICAgICAgICAgIFt0YWJJbmRleF09XCItMVwiXG4gICAgICAgICAgICBbY2xhc3NdPVwiX2NsYXNzKClcIlxuICAgICAgICAgICAgZGF0YS1zb25uZXItdG9hc3RlclxuICAgICAgICAgICAgW2F0dHIuZGF0YS10aGVtZV09XCJhY3R1YWxUaGVtZSgpXCJcbiAgICAgICAgICAgIFthdHRyLmRhdGEtcmljaC1jb2xvcnNdPVwicmljaENvbG9ycygpXCJcbiAgICAgICAgICAgIFthdHRyLmRpcl09XCJkaXIoKSA9PT0gJ2F1dG8nID8gZ2V0RG9jdW1lbnREaXJlY3Rpb24oKSA6IGRpcigpXCJcbiAgICAgICAgICAgIFthdHRyLmRhdGEteS1wb3NpdGlvbl09XCJwb3Muc3BsaXQoJy0nKVswXVwiXG4gICAgICAgICAgICBbYXR0ci5kYXRhLXgtcG9zaXRpb25dPVwicG9zLnNwbGl0KCctJylbMV1cIlxuICAgICAgICAgICAgKGJsdXIpPVwiaGFuZGxlQmx1cigkZXZlbnQpXCJcbiAgICAgICAgICAgIChmb2N1cyk9XCJoYW5kbGVGb2N1cygkZXZlbnQpXCJcbiAgICAgICAgICAgIChtb3VzZWVudGVyKT1cImV4cGFuZGVkLnNldCh0cnVlKVwiXG4gICAgICAgICAgICAobW91c2Vtb3ZlKT1cImV4cGFuZGVkLnNldCh0cnVlKVwiXG4gICAgICAgICAgICAobW91c2VsZWF2ZSk9XCJoYW5kbGVNb3VzZUxlYXZlKClcIlxuICAgICAgICAgICAgKHBvaW50ZXJkb3duKT1cImludGVyYWN0aW5nLnNldCh0cnVlKVwiXG4gICAgICAgICAgICAocG9pbnRlcnVwKT1cImludGVyYWN0aW5nLnNldChmYWxzZSlcIlxuICAgICAgICAgICAgW3N0eWxlXT1cInRvYXN0ZXJTdHlsZXMoKVwiPlxuICAgICAgICAgICAgQGZvciAoXG4gICAgICAgICAgICAgIHRvYXN0IG9mIHRvYXN0cygpIHwgdG9hc3RQb3NpdGlvbjogJGluZGV4IDogcG9zO1xuICAgICAgICAgICAgICB0cmFjayB0b2FzdC5pZFxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgIDxuZ3gtc29ubmVyLXRvYXN0XG4gICAgICAgICAgICAgICAgW2luZGV4XT1cIiRpbmRleFwiXG4gICAgICAgICAgICAgICAgW3RvYXN0XT1cInRvYXN0XCJcbiAgICAgICAgICAgICAgICBbaW52ZXJ0XT1cImludmVydCgpXCJcbiAgICAgICAgICAgICAgICBbdmlzaWJsZVRvYXN0c109XCJ2aXNpYmxlVG9hc3RzKClcIlxuICAgICAgICAgICAgICAgIFtjbG9zZUJ1dHRvbl09XCJjbG9zZUJ1dHRvbigpXCJcbiAgICAgICAgICAgICAgICBbaW50ZXJhY3RpbmddPVwiaW50ZXJhY3RpbmcoKVwiXG4gICAgICAgICAgICAgICAgW3Bvc2l0aW9uXT1cInBvc2l0aW9uKClcIlxuICAgICAgICAgICAgICAgIFtleHBhbmRCeURlZmF1bHRdPVwiZXhwYW5kKClcIlxuICAgICAgICAgICAgICAgIFtleHBhbmRlZF09XCJleHBhbmRlZCgpXCJcbiAgICAgICAgICAgICAgICBbYWN0aW9uQnV0dG9uU3R5bGVdPVwidG9hc3RPcHRpb25zKCkuYWN0aW9uQnV0dG9uU3R5bGVcIlxuICAgICAgICAgICAgICAgIFtjYW5jZWxCdXR0b25TdHlsZV09XCJ0b2FzdE9wdGlvbnMoKS5jYW5jZWxCdXR0b25TdHlsZVwiXG4gICAgICAgICAgICAgICAgW2NsYXNzXT1cInRvYXN0T3B0aW9ucygpLmNsYXNzID8/ICcnXCJcbiAgICAgICAgICAgICAgICBbZGVzY3JpcHRpb25DbGFzc109XCJ0b2FzdE9wdGlvbnMoKS5kZXNjcmlwdGlvbkNsYXNzID8/ICcnXCJcbiAgICAgICAgICAgICAgICBbY2xhc3Nlc109XCJ0b2FzdE9wdGlvbnMoKS5jbGFzc2VzID8/IHt9XCJcbiAgICAgICAgICAgICAgICBbZHVyYXRpb25dPVwidG9hc3RPcHRpb25zKCkuZHVyYXRpb24gPz8gZHVyYXRpb24oKVwiXG4gICAgICAgICAgICAgICAgW3Vuc3R5bGVkXT1cInRvYXN0T3B0aW9ucygpLnVuc3R5bGVkID8/IGZhbHNlXCI+XG4gICAgICAgICAgICAgICAgPG5neC1zb25uZXItbG9hZGVyXG4gICAgICAgICAgICAgICAgICBbaXNWaXNpYmxlXT1cInRvYXN0LnR5cGUgPT09ICdsb2FkaW5nJ1wiXG4gICAgICAgICAgICAgICAgICBsb2FkaW5nLWljb24gLz5cbiAgICAgICAgICAgICAgICA8bmd4LXNvbm5lci1pY29uIHR5cGU9XCJzdWNjZXNzXCIgc3VjY2Vzcy1pY29uIC8+XG4gICAgICAgICAgICAgICAgPG5neC1zb25uZXItaWNvbiB0eXBlPVwiZXJyb3JcIiBlcnJvci1pY29uIC8+XG4gICAgICAgICAgICAgICAgPG5neC1zb25uZXItaWNvbiB0eXBlPVwid2FybmluZ1wiIHdhcm5pbmctaWNvbiAvPlxuICAgICAgICAgICAgICAgIDxuZ3gtc29ubmVyLWljb24gdHlwZT1cImluZm9cIiBpbmZvLWljb24gLz5cbiAgICAgICAgICAgICAgPC9uZ3gtc29ubmVyLXRvYXN0PlxuICAgICAgICAgICAgfVxuICAgICAgICAgIDwvb2w+XG4gICAgICAgIH1cbiAgICAgIDwvc2VjdGlvbj5cbiAgICB9XG4gIGAsXG4gIHN0eWxlVXJsOiAndG9hc3Rlci5jb21wb25lbnQuY3NzJyxcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG59KVxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEBhbmd1bGFyLWVzbGludC9jb21wb25lbnQtY2xhc3Mtc3VmZml4XG5leHBvcnQgY2xhc3MgTmd4U29ubmVyVG9hc3RlciBpbXBsZW1lbnRzIE9uRGVzdHJveSB7XG4gIHByaXZhdGUgcmVhZG9ubHkgcGxhdGZvcm1JZCA9IGluamVjdChQTEFURk9STV9JRCk7XG5cbiAgdG9hc3RzID0gdG9hc3RTdGF0ZS50b2FzdHM7XG4gIGhlaWdodHMgPSB0b2FzdFN0YXRlLmhlaWdodHM7XG4gIHJlc2V0ID0gdG9hc3RTdGF0ZS5yZXNldDtcblxuICBpbnZlcnQgPSBpbnB1dDxUb2FzdGVyUHJvcHNbJ2ludmVydCddLCBib29sZWFuIHwgc3RyaW5nPihmYWxzZSwge1xuICAgIHRyYW5zZm9ybTogYm9vbGVhbkF0dHJpYnV0ZSxcbiAgfSk7XG4gIHRoZW1lID0gaW5wdXQ8VG9hc3RlclByb3BzWyd0aGVtZSddPignbGlnaHQnKTtcbiAgcG9zaXRpb24gPSBpbnB1dDxUb2FzdGVyUHJvcHNbJ3Bvc2l0aW9uJ10+KCdib3R0b20tcmlnaHQnKTtcbiAgaG90S2V5ID0gaW5wdXQ8VG9hc3RlclByb3BzWydob3RrZXknXT4oWydhbHRLZXknLCAnS2V5VCddKTtcbiAgcmljaENvbG9ycyA9IGlucHV0PFRvYXN0ZXJQcm9wc1sncmljaENvbG9ycyddLCBib29sZWFuIHwgc3RyaW5nPihmYWxzZSwge1xuICAgIHRyYW5zZm9ybTogYm9vbGVhbkF0dHJpYnV0ZSxcbiAgfSk7XG4gIGV4cGFuZCA9IGlucHV0PFRvYXN0ZXJQcm9wc1snZXhwYW5kJ10sIGJvb2xlYW4gfCBzdHJpbmc+KGZhbHNlLCB7XG4gICAgdHJhbnNmb3JtOiBib29sZWFuQXR0cmlidXRlLFxuICB9KTtcbiAgZHVyYXRpb24gPSBpbnB1dDxUb2FzdGVyUHJvcHNbJ2R1cmF0aW9uJ10sIG51bWJlciB8IHN0cmluZz4oVE9BU1RfTElGRVRJTUUsIHtcbiAgICB0cmFuc2Zvcm06IG51bWJlckF0dHJpYnV0ZSxcbiAgfSk7XG4gIHZpc2libGVUb2FzdHMgPSBpbnB1dDxUb2FzdGVyUHJvcHNbJ3Zpc2libGVUb2FzdHMnXSwgbnVtYmVyIHwgc3RyaW5nPihcbiAgICBWSVNJQkxFX1RPQVNUU19BTU9VTlQsXG4gICAgeyB0cmFuc2Zvcm06IG51bWJlckF0dHJpYnV0ZSB9XG4gICk7XG4gIGNsb3NlQnV0dG9uID0gaW5wdXQ8VG9hc3RlclByb3BzWydjbG9zZUJ1dHRvbiddLCBib29sZWFuIHwgc3RyaW5nPihmYWxzZSwge1xuICAgIHRyYW5zZm9ybTogYm9vbGVhbkF0dHJpYnV0ZSxcbiAgfSk7XG4gIHRvYXN0T3B0aW9ucyA9IGlucHV0PFRvYXN0ZXJQcm9wc1sndG9hc3RPcHRpb25zJ10+KHt9KTtcbiAgb2Zmc2V0ID0gaW5wdXQ8VG9hc3RlclByb3BzWydvZmZzZXQnXT4obnVsbCk7XG4gIGRpciA9IGlucHV0PFRvYXN0ZXJQcm9wc1snZGlyJ10+KHRoaXMuZ2V0RG9jdW1lbnREaXJlY3Rpb24oKSk7XG4gIF9jbGFzcyA9IGlucHV0KCcnLCB7IGFsaWFzOiAnY2xhc3MnIH0pO1xuICBfc3R5bGUgPSBpbnB1dDxSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+Pih7fSwgeyBhbGlhczogJ3N0eWxlJyB9KTtcblxuICBwb3NzaWJsZVBvc2l0aW9ucyA9IGNvbXB1dGVkKFxuICAgICgpID0+XG4gICAgICBBcnJheS5mcm9tKFxuICAgICAgICBuZXcgU2V0KFxuICAgICAgICAgIFtcbiAgICAgICAgICAgIHRoaXMucG9zaXRpb24oKSxcbiAgICAgICAgICAgIC4uLnRoaXMudG9hc3RzKClcbiAgICAgICAgICAgICAgLmZpbHRlcih0b2FzdCA9PiB0b2FzdC5wb3NpdGlvbilcbiAgICAgICAgICAgICAgLm1hcCh0b2FzdCA9PiB0b2FzdC5wb3NpdGlvbiksXG4gICAgICAgICAgXS5maWx0ZXIoQm9vbGVhbilcbiAgICAgICAgKVxuICAgICAgKSBhcyBQb3NpdGlvbltdXG4gICk7XG5cbiAgZXhwYW5kZWQgPSBzaWduYWwoZmFsc2UpO1xuICBpbnRlcmFjdGluZyA9IHNpZ25hbChmYWxzZSk7XG4gIGFjdHVhbFRoZW1lID0gc2lnbmFsKHRoaXMuZ2V0QWN0dWFsVGhlbWUodGhpcy50aGVtZSgpKSk7XG5cbiAgLy8gdmlld0NoaWxkPEhUTUxPTGlzdEVsZW1lbnQ+KCdsaXN0UmVmJyk7XG4gIEBWaWV3Q2hpbGQoJ2xpc3RSZWYnKSBsaXN0UmVmITogRWxlbWVudFJlZjxIVE1MT0xpc3RFbGVtZW50PjtcbiAgbGFzdEZvY3VzZWRFbGVtZW50UmVmID0gc2lnbmFsPEhUTUxFbGVtZW50IHwgbnVsbD4obnVsbCk7XG4gIGlzRm9jdXNXaXRoaW5SZWYgPSBzaWduYWwoZmFsc2UpO1xuXG4gIGhvdEtleUxhYmVsID0gY29tcHV0ZWQoKCkgPT5cbiAgICB0aGlzLmhvdEtleSgpLmpvaW4oJysnKS5yZXBsYWNlKC9LZXkvZywgJycpLnJlcGxhY2UoL0RpZ2l0L2csICcnKVxuICApO1xuXG4gIHRvYXN0ZXJTdHlsZXMgPSBjb21wdXRlZCgoKSA9PiAoe1xuICAgICctLWZyb250LXRvYXN0LWhlaWdodCc6IGAke3RoaXMuaGVpZ2h0cygpWzBdPy5oZWlnaHR9cHhgLFxuICAgICctLW9mZnNldCc6XG4gICAgICB0eXBlb2YgdGhpcy5vZmZzZXQoKSA9PT0gJ251bWJlcidcbiAgICAgICAgPyBgJHt0aGlzLm9mZnNldCgpfXB4YFxuICAgICAgICA6IHRoaXMub2Zmc2V0KCkgPz8gYCR7VklFV1BPUlRfT0ZGU0VUfWAsXG4gICAgJy0td2lkdGgnOiBgJHtUT0FTVF9XSURUSH1weGAsXG4gICAgJy0tZ2FwJzogYCR7R0FQfXB4YCxcbiAgICAuLi50aGlzLl9zdHlsZSgpLFxuICB9KSk7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5yZXNldCgpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmhhbmRsZUtleWRvd24pO1xuXG4gICAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm1JZCkpIHtcbiAgICAgIHdpbmRvd1xuICAgICAgICAubWF0Y2hNZWRpYSgnKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKScpXG4gICAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLmhhbmRsZVRoZW1lUHJlZmVyZW5jZUNoYW5nZSk7XG4gICAgfVxuXG4gICAgZWZmZWN0KCgpID0+IHtcbiAgICAgIGlmICh0aGlzLnRvYXN0cygpLmxlbmd0aCA+PSAxKSB7XG4gICAgICAgIHVudHJhY2tlZCgoKSA9PiB0aGlzLmV4cGFuZGVkLnNldChmYWxzZSkpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgZWZmZWN0KCgpID0+IHtcbiAgICAgIGNvbnN0IHRoZW1lID0gdGhpcy50aGVtZSgpO1xuICAgICAgdW50cmFja2VkKCgpID0+IHRoaXMuYWN0dWFsVGhlbWUuc2V0KHRoaXMuZ2V0QWN0dWFsVGhlbWUodGhlbWUpKSk7XG4gICAgfSk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpIHtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5oYW5kbGVLZXlkb3duKTtcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xuICAgICAgd2luZG93XG4gICAgICAgIC5tYXRjaE1lZGlhKCcocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspJylcbiAgICAgICAgLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRoaXMuaGFuZGxlVGhlbWVQcmVmZXJlbmNlQ2hhbmdlKTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVCbHVyKGV2ZW50OiBGb2N1c0V2ZW50KSB7XG4gICAgaWYgKFxuICAgICAgdGhpcy5pc0ZvY3VzV2l0aGluUmVmKCkgJiZcbiAgICAgICEoZXZlbnQudGFyZ2V0IGFzIEhUTUxPTGlzdEVsZW1lbnQpLmNvbnRhaW5zKFxuICAgICAgICBldmVudC5yZWxhdGVkVGFyZ2V0IGFzIEhUTUxFbGVtZW50XG4gICAgICApXG4gICAgKSB7XG4gICAgICB0aGlzLmlzRm9jdXNXaXRoaW5SZWYuc2V0KGZhbHNlKTtcbiAgICAgIGlmICh0aGlzLmxhc3RGb2N1c2VkRWxlbWVudFJlZigpKSB7XG4gICAgICAgIHRoaXMubGFzdEZvY3VzZWRFbGVtZW50UmVmKCk/LmZvY3VzKHsgcHJldmVudFNjcm9sbDogdHJ1ZSB9KTtcbiAgICAgICAgdGhpcy5sYXN0Rm9jdXNlZEVsZW1lbnRSZWYuc2V0KG51bGwpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGhhbmRsZUZvY3VzKGV2ZW50OiBGb2N1c0V2ZW50KSB7XG4gICAgaWYgKCF0aGlzLmlzRm9jdXNXaXRoaW5SZWYoKSkge1xuICAgICAgdGhpcy5pc0ZvY3VzV2l0aGluUmVmLnNldCh0cnVlKTtcbiAgICAgIHRoaXMubGFzdEZvY3VzZWRFbGVtZW50UmVmLnNldChldmVudC5yZWxhdGVkVGFyZ2V0IGFzIEhUTUxFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVNb3VzZUxlYXZlKCkge1xuICAgIGlmICghdGhpcy5pbnRlcmFjdGluZygpKSB7XG4gICAgICB0aGlzLmV4cGFuZGVkLnNldChmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVLZXlkb3duID0gKGV2ZW50OiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgaWYgKCF0aGlzLmxpc3RSZWY/Lm5hdGl2ZUVsZW1lbnQpIHJldHVybjtcblxuICAgIGNvbnN0IGlzSG90a2V5UHJlc3NlZCA9IHRoaXMuaG90S2V5KCkuZXZlcnkoXG4gICAgICBrZXkgPT4gKGV2ZW50IGFzIG5ldmVyKVtrZXldIHx8IGV2ZW50LmNvZGUgPT09IGtleVxuICAgICk7XG5cbiAgICBpZiAoaXNIb3RrZXlQcmVzc2VkKSB7XG4gICAgICB0aGlzLmV4cGFuZGVkLnNldCh0cnVlKTtcbiAgICAgIHRoaXMubGlzdFJlZi5uYXRpdmVFbGVtZW50Py5mb2N1cygpO1xuICAgIH1cblxuICAgIGlmIChcbiAgICAgIGV2ZW50LmNvZGUgPT09ICdFc2NhcGUnICYmXG4gICAgICAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gdGhpcy5saXN0UmVmLm5hdGl2ZUVsZW1lbnQgfHxcbiAgICAgICAgdGhpcy5saXN0UmVmLm5hdGl2ZUVsZW1lbnQ/LmNvbnRhaW5zKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpKVxuICAgICkge1xuICAgICAgdGhpcy5leHBhbmRlZC5zZXQoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICBwcml2YXRlIGhhbmRsZVRoZW1lUHJlZmVyZW5jZUNoYW5nZSA9ICh7IG1hdGNoZXMgfTogTWVkaWFRdWVyeUxpc3RFdmVudCkgPT4ge1xuICAgIGlmICh0aGlzLnRoZW1lKCkgPT09ICdzeXN0ZW0nKSB7XG4gICAgICB0aGlzLmFjdHVhbFRoZW1lLnNldChtYXRjaGVzID8gJ2RhcmsnIDogJ2xpZ2h0Jyk7XG4gICAgfVxuICB9O1xuXG4gIHByaXZhdGUgZ2V0QWN0dWFsVGhlbWUodDogVGhlbWUpIHtcbiAgICBpZiAodCAhPT0gJ3N5c3RlbScpIHtcbiAgICAgIHJldHVybiB0O1xuICAgIH1cblxuICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtSWQpKSB7XG4gICAgICBpZiAoXG4gICAgICAgIHdpbmRvdy5tYXRjaE1lZGlhICYmXG4gICAgICAgIHdpbmRvdy5tYXRjaE1lZGlhKCcocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspJykubWF0Y2hlc1xuICAgICAgKSB7XG4gICAgICAgIHJldHVybiAnZGFyayc7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiAnbGlnaHQnO1xuICAgIH1cblxuICAgIHJldHVybiAnbGlnaHQnO1xuICB9XG5cbiAgZ2V0RG9jdW1lbnREaXJlY3Rpb24oKTogVG9hc3RlclByb3BzWydkaXInXSB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSByZXR1cm4gJ2x0cic7XG4gICAgaWYgKHR5cGVvZiBkb2N1bWVudCA9PT0gJ3VuZGVmaW5lZCcpIHJldHVybiAnbHRyJzsgLy8gRm9yIEZyZXNoIHB1cnBvc2VcblxuICAgIGNvbnN0IGRpckF0dHJpYnV0ZSA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RpcicpO1xuXG4gICAgaWYgKGRpckF0dHJpYnV0ZSA9PT0gJ2F1dG8nIHx8ICFkaXJBdHRyaWJ1dGUpIHtcbiAgICAgIHJldHVybiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpXG4gICAgICAgIC5kaXJlY3Rpb24gYXMgVG9hc3RlclByb3BzWydkaXInXTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGlyQXR0cmlidXRlIGFzIFRvYXN0ZXJQcm9wc1snZGlyJ107XG4gIH1cbn1cbiJdfQ==